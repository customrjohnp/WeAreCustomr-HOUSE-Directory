<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Email Directory — Customr</title>
  <meta name="description" content="Self-hosted directory of automation programs and email HTML previews." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* ===== THEME: Customr light (white + orange) ===== */
    :root{
      --bg:#ffffff;
      --panel:#ffffff;
      --muted:#6b7280;             /* subdued copy */
      --text:#0b0c0f;              /* near-black body text */
      --brand:#ff6a00;             /* Customr orange */
      --brand-2:#cc5400;           /* darker orange for depth */
      --ring:#ffb072;              /* focus ring tint */
      --stroke:#e5e7eb;            /* light borders */
      --mono: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
      --elev: 0 10px 30px rgba(17,24,39,.06); /* soft light shadow */
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      background:linear-gradient(180deg,#ffffff,#fafafa 40%, #ffffff);
      color:var(--text);
    }

    .container{max-width:1200px;margin:0 auto;padding:24px}

    header{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:16px}
    .brand{display:flex;gap:10px;align-items:center;font-weight:700}
    .brand .dot{width:10px;height:10px;border-radius:50%;background:var(--brand);box-shadow:0 0 0 4px rgba(255,106,0,.25)}
    h1{font-size:clamp(22px,3vw,30px);margin:0}
    .muted{color:var(--muted)}

    /* House × Customr brand bar (text only) */
    .brandbar{
      display:flex;align-items:center;justify-content:center;
      background:linear-gradient(90deg, rgba(255,106,0,.12), rgba(255,106,0,.04));
      border:1px solid var(--stroke);
      border-radius:14px;
      padding:14px;
      gap:12px;
      margin-bottom:14px;
      box-shadow:var(--elev);
    }
    .brandbar .tag{
      padding:6px 10px;border:1px solid rgba(255,106,0,.35);
      border-radius:999px;font-weight:600;color:#8a3b00;background:rgba(255,106,0,.10)
    }

    /* Panels / tabs */
    .panel{background:var(--panel);border:1px solid var(--stroke);border-radius:14px;box-shadow:var(--elev)}
    .tabs{display:flex;gap:8px;padding:12px 14px;border-bottom:1px solid var(--stroke)}
    .tab{
      appearance:none;border:1px solid var(--stroke);background:#fff;color:var(--text);
      border-radius:10px;padding:10px 12px;font-weight:600;cursor:pointer
    }
    .tab[aria-selected="true"]{
      background:linear-gradient(180deg,var(--brand),var(--brand-2));
      border-color:#9b4a15;color:#fff
    }

    /* Filters */
    .toolbar{display:grid;grid-template-columns:1fr 200px 150px 150px;gap:10px;padding:14px}
    .field{position:relative}
    input[type="search"],select{
      width:100%;background:#fff;border:1px solid var(--stroke);color:var(--text);
      padding:12px 14px;border-radius:10px;outline:none
    }
    input[type="search"]:focus,select:focus{border-color:var(--brand);box-shadow:0 0 0 3px rgba(255,106,0,.20)}

    /* Cards / chips / code */
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:12px;padding:14px}
    .card{background:#fff;border:1px solid var(--stroke);border-radius:14px;padding:14px;display:flex;flex-direction:column;gap:10px;box-shadow:var(--elev)}
    .badge{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;border:1px solid #e2e8f0;color:#0f172a;background:#f8fafc;font-size:12px}
    .badge.orange{border-color:rgba(255,106,0,.35);color:#8a3b00;background:rgba(255,106,0,.10)}
    .meta{display:flex;flex-wrap:wrap;gap:6px}
    .row{display:flex;gap:8px;align-items:center;justify-content:space-between}
    .code{font-family:var(--mono);font-size:12px;color:#334155;background:#f8fafc;border:1px dashed #e2e8f0;border-radius:8px;padding:8px;overflow:auto}

    /* Buttons (keep darker-orange glow) */
    .actions{display:flex;gap:8px;flex-wrap:wrap}
    .btn{
      appearance:none;border:1px solid var(--stroke);border-radius:10px;padding:10px 12px;font-weight:600;cursor:pointer;
      background:#fff;color:#0b0c0f;box-shadow:0 1px 0 rgba(0,0,0,.04)
    }
    .btn:hover{border-color:#d1d5db}
    .btn.primary{
      background:linear-gradient(180deg,var(--brand),var(--brand-2));border-color:#9b4a15;color:#fff;
      box-shadow:0 8px 20px rgba(204,84,0,.25)   /* shadow-like darker orange */
    }
    .btn.ghost{background:transparent;border:1px dashed #cbd5e1}
    .btn.disabled{opacity:.5;cursor:not-allowed}

    .thumb{width:100%;aspect-ratio:16/9;object-fit:cover;border-radius:10px;border:1px solid var(--stroke);background:#fff}

    /* Footer (kept dark to match site) */
    .footer{font-size:12px;padding:24px;text-align:center;background:#232a33;border:1px solid #1f2630;border-radius:14px;margin:16px 0 0;color:#e5e7eb}
    .footer-inner{display:flex;flex-direction:column;gap:8px;align-items:center}
    .footer-brand{display:flex;align-items:center;gap:8px;font-weight:700;color:#fff}
    .footer-nav a{color:#ffd7bf;text-decoration:none;margin:0 8px}
    .footer-nav a:hover{text-decoration:underline}

    /* Overlays */
    .overlay{position:fixed;inset:0;display:none;background:rgba(0,0,0,.65);z-index:1000}
    #overlay{z-index:1100;}
    .overlay.show{display:block}
    .ov-panel{position:absolute;inset:30px;display:flex;flex-direction:column;background:#fff;border:1px solid var(--stroke);border-radius:14px;box-shadow:0 20px 60px rgba(0,0,0,.14)}
    .ov-bar{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--stroke);padding:10px 12px}
    .ov-title{font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .ov-actions{display:flex;gap:8px}
    .ov-iframe{border:0;width:100%;height:calc(100% - 48px);background:#fff}
    .ov-content{padding:14px;overflow:auto;height:calc(100% - 48px)}
    .ov-cols{display:grid;grid-template-columns:1.2fr 1fr;gap:14px}
    .close-x{background:transparent;border:1px solid #cbd5e1;border-radius:8px;color:#0b0c0f;padding:8px 10px;cursor:pointer}

    @media (max-width:900px){
      .toolbar{grid-template-columns:1fr 1fr 1fr}
      .ov-cols{grid-template-columns:1fr}
    }
  </style>
</head>

<body>
  <div class="container">
    <header>
      <div class="brand"><span class="dot" aria-hidden="true"></span><h1>Email Directory</h1></div>
      <div class="muted">Automation programs • Email previews — By Customr</div>
    </header>

    <!-- Brand bar (no banner image) -->
    <section class="brandbar" aria-label="House × Customr">
      <span class="tag">House × Customr</span>
      <div class="muted">Partnership workspace — previews, program maps & shareable links</div>
    </section>

    <section class="panel" aria-labelledby="filters-heading">
      <div class="tabs" role="tablist">
        <button id="tab-programs" class="tab" role="tab" aria-controls="programs-view" aria-selected="true">Programs</button>
        <button id="tab-emails" class="tab" role="tab" aria-controls="emails-view" aria-selected="false">Emails</button>
      </div>

      <h2 id="filters-heading" class="visually-hidden" style="position:absolute;left:-9999px">Filters</h2>
      <div class="toolbar">
        <label class="field"><input type="search" id="q" placeholder="Search… e.g., Welcome Series, Abandoned Cart, VIP" aria-label="Search" /></label>
        <label class="field"><select id="programFilter"><option value="">All programs</option></select></label>
        <label class="field"><select id="type"><option value="">All types</option></select></label>
        <label class="field"><select id="sort">
          <option value="date_desc">Newest first</option>
          <option value="date_asc">Oldest first</option>
          <option value="name_asc">Name A→Z</option>
        </select></label>
      </div>

      <div id="programs-view" class="grid" aria-live="polite"></div>
      <div id="emails-view" class="grid" aria-live="polite" style="display:none"></div>
    </section>

    <!-- FOOTER -->
    <footer class="footer">
      <div class="footer-inner">
        <div class="footer-brand"><span class="dot" aria-hidden="true"></span>WeAreCustomr</div>
        <nav class="footer-nav" aria-label="WeAreCustomr links">
          <a href="https://www.wearecustomr.com.au/" target="_blank" rel="noopener">Website</a>
          <a href="https://www.wearecustomr.com.au/data-insights" target="_blank" rel="noopener">Data & Insights</a>
          <a href="https://www.wearecustomr.com.au/crm" target="_blank" rel="noopener">CRM</a>
          <a href="https://www.wearecustomr.com.au/loyalty" target="_blank" rel="noopener">Loyalty</a>
          <a href="https://www.wearecustomr.com.au/technology" target="_blank" rel="noopener">Technology</a>
        </nav>
        <div class="footer-legal">© <span id="year"></span> WeAreCustomr. All rights reserved.</div>
      </div>
    </footer>
  </div>

  <!-- ===== Email preview overlay (iframe) ===== -->
  <div id="overlay" class="overlay" aria-hidden="true">
    <div class="ov-panel" role="dialog" aria-modal="true" aria-labelledby="ov-title">
      <div class="ov-bar">
        <div id="ov-title" class="ov-title">Preview</div>
        <div class="ov-actions">
          <a id="ov-open" class="btn" href="#" target="_blank" rel="noopener">Open in new tab</a>
          <a id="ov-download" class="btn ghost" href="#" download>Download HTML</a>
          <button id="ov-close" class="close-x" aria-label="Close">Close</button>
        </div>
      </div>
      <iframe id="ov-frame" class="ov-iframe" loading="lazy"></iframe>
    </div>
  </div>

  <!-- ===== Program overlay (image + logic + list of emails) ===== -->
  <div id="prog-overlay" class="overlay" aria-hidden="true">
    <div class="ov-panel" role="dialog" aria-modal="true" aria-labelledby="prog-title">
      <div class="ov-bar">
        <div id="prog-title" class="ov-title">Program</div>
        <div class="ov-actions"><button id="prog-close" class="close-x" aria-label="Close">Close</button></div>
      </div>
      <div class="ov-content">
        <div class="ov-cols">
          <div><img id="prog-img" class="thumb" alt="Program screenshot" /></div>
          <div>
            <div id="prog-summary" class="muted" style="margin-bottom:8px"></div>
            <ul id="prog-bullets" style="margin:0 0 12px 18px"></ul>
            <div id="prog-emails-title" style="font-weight:700;margin:8px 0">Included Emails</div>
            <div id="prog-emails" class="grid" style="grid-template-columns:1fr"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    /* ===== PRESETS (types) ===== */
    const TYPES_PRESET = ["Marketing","Automation","Transactional"];

    /* ===== PROGRAMS (House) =====
       noEmails:true = program acts as router/traffic-controller; show info only */
    const PROGRAMS = [
      {
        id: "house_welcome_series",
        title: "[FUTURE STATE] Welcome Series (Online & In Store)",
        categoryForEmails: "Welcome Series",
        image: "House/Program Screenshots/[FUTURE STATE] Welcome Series (Online & In Store).png",
        summary: "Introduces new subscribers and recent purchasers; splits Online vs In-store and Lead vs Customer; voucher/no-code logic.",
        bullets: [
          "Entry: New Contact; acquisition source split",
          "VIP join and recent purchase checks",
          "Lead Emails 1–3; Customer Emails 1–2; In-store VIP variants",
          "Voucher vs No-code treatment",
          "Loyalty onboarding branch for eligible"
        ]
      },
      {
        id: "house_abandoned_cart_adv",
        title: "[FUTURE STATE] Fast Abandoned Cart — Advanced",
        categoryForEmails: "Abandoned Cart",
        image: "House/Program Screenshots/[FUTURE STATE] Fast Abandoned Cart - Advanced.png",
        summary: "Accelerated cart recovery with multi-step reminders, VIP handling, dynamic product blocks.",
        bullets: [
          "Triggers on cart events; excludes recent purchasers",
          "Dynamic product recs; VIP voucher branch",
          "Tuned waits and stop rules",
          "Strict staff/test exclusions"
        ]
      },
      {
        id: "house_abandoned_cart_external",
        title: "Abandoned Cart — External Event",
        categoryForEmails: "Abandoned Cart (External)",
        image: "House/Program Screenshots/[FUTURE STATE] Fast Abandoned Cart - External Event.png",
        summary: "Abandoned Cart variant triggered by external event payload; mirrors Fast AC logic with source-specific checks.",
        bullets: [
          "Triggered by external source payload",
          "Same content family; adjusted filters",
          "Four-step reminders; stop on purchase"
        ]
      },
      {
        id: "house_reengagement",
        title: "[FUTURE STATE] Re-Engagement Flow",
        categoryForEmails: "Re-Engagement",
        image: "House/Program Screenshots/[FUTURE STATE] Re-Engagement Flow.png",
        summary: "Wins back disengaged profiles via progressive content and incentives.",
        bullets: ["Mild → Moderate → Severe disengagement", "Value-first then incentive", "Stops on open/click/purchase"]
      },
      {
        id: "house_post_purchase_cats",
        title: "[FUTURE STATE] Post-Purchase (Categories)",
        categoryForEmails: "Post-Purchase",
        image: "House/Program Screenshots/[FUTURE STATE] Post-Purchase (Categories).png",
        summary: "Category-led aftercare, cross-sell, care tips, and review prompts.",
        bullets: ["Category routes", "Aftercare + how-to", "Cross-sell + reviews"]
      },
      {
        id: "house_cross_sell_pf",
        title: "[Future State] Cross-Sell Product Focused",
        categoryForEmails: "Cross-Sell Product Focused",
        image: "House/Program Screenshots/[Future State] Cross-Sell Product Focused.png",
        summary: "Follow-up cross-sell tailored to purchased product.",
        bullets: ["SKU/brand targeting", "Accessory add-ons", "Time-based sends"]
      },
      {
        id: "house_vip_anniversary",
        title: "VIP Anniversary Offer",
        categoryForEmails: "VIP Anniversary",
        image: "House/Program Screenshots/VIP Anniversary Offer.png",
        summary: "Celebratory message with VIP-tier logic and time-boxed voucher.",
        bullets: ["VIP tier check", "Personalisation", "Voucher/no-code rules"]
      },
      {
        id: "house_in_session_cross_sell",
        title: "In-Session Cross-Sell",
        image: "House/Program Screenshots/In-Session Cross-Sell.png",
        noEmails: true,
        summary:
          "When a shopper leaves items in their cart, the program identifies the category (e.g., toaster, kettle, rice cooker) and routes them into tailored cross-sell paths where relevant campaigns are triggered outside this flow. Built as a ‘traffic controller,’ it ensures customers only receive product-specific offers and exit immediately on purchase to prevent over-sending.",
        bullets: [
          "Routes by product category (e.g., toaster/kettle)",
          "Triggers downstream, category-specific campaigns",
          "Immediate exit on purchase to prevent over-sending"
        ]
      }
    ];

    /* ===== EMAILS (House / GRB) =====
       For placeholders (not uploaded yet), set placeholder:true — the View/Download
       buttons are disabled with a ‘Placeholder’ badge. */
    const EMAILS = [
      /* Welcome Series — Online LEAD */
      { id:"Auto_WelcomeSeries_Online_Lead_Email_01", type:"Automation", date:"2025-09-22",
        category:["Welcome Series","Online"], tags:["Lead","Welcome"],
        path:"Emails/GRB/House/[FUTURE STATE] Welcome Series (Online & In Store)/Auto_WelcomeSeries_Online_Lead_Email_01.html",
        notes:"Intro hero, $20 off WELCOME20 (2wks), value props, dynamic recs, rewards CTA" },
      { id:"Auto_WelcomeSeries_Online_Lead_Email_02", type:"Automation", date:"2025-09-19",
        category:["Welcome Series","Online"], tags:["Lead"],
        path:"Emails/GRB/House/[FUTURE STATE] Welcome Series (Online & In Store)/Auto_WelcomeSeries_Online_Lead_Email_02.html",
        notes:"Lifestyle hero + brand highlights, USPs, shop-by-category tiles" },
      { id:"Auto_WelcomeSeries_Online_Lead_Email_03", type:"Automation", date:"2025-09-16",
        category:["Welcome Series","Online"], tags:["Lead"],
        path:"Emails/GRB/House/[FUTURE STATE] Welcome Series (Online & In Store)/Auto_WelcomeSeries_Online_Lead_Email_03.html",
        notes:"Story tile + editorial section" },

      /* Welcome Series — Online CUSTOMER */
      { id:"Auto_WelcomeSeries_Online_Customer_Email_01", type:"Automation", date:"2025-09-10",
        category:["Welcome Series","Online"], tags:["Customer"],
        path:"Emails/GRB/House/[FUTURE STATE] Welcome Series (Online & In Store)/Auto_WelcomeSeries_Online_Customer_Email_01.html",
        notes:"Post-purchase welcome, ‘Discover more to love’, USPs, Predict x3" },
      { id:"Auto_WelcomeSeries_Online_Customer_Email_02", type:"Automation", date:"2025-09-08",
        category:["Welcome Series","Online"], tags:["Customer"],
        path:"Emails/GRB/House/[FUTURE STATE] Welcome Series (Online & In Store)/Auto_WelcomeSeries_Online_Customer_Email_02.html",
        notes:"Follow-up with care/use tips and related categories" },

      /* Welcome Series — In-Store VIP */
      { id:"Auto_WelcomeSeries_InStore_VIP_Email_01", type:"Automation", date:"2025-09-06",
        category:["Welcome Series","In Store","VIP"], tags:["VIP","In-store"],
        path:"Emails/GRB/House/[FUTURE STATE] Welcome Series (Online & In Store)/Auto_WelcomeSeries_InStore_VIP_Email_01.html",
        notes:"In-store VIP variant — voucher logic, store services, benefits" },
      { id:"Auto_WelcomeSeries_InStore_VIP_Email_02", type:"Automation", date:"2025-09-04",
        category:["Welcome Series","In Store","VIP"], tags:["VIP","In-store"],
        path:"Emails/GRB/House/[FUTURE STATE] Welcome Series (Online & In Store)/Auto_WelcomeSeries_InStore_VIP_Email_02.html",
        notes:"VIP reminder; product curation; store locator CTA" },
      { id:"Auto_WelcomeSeries_InStore_VIP_Email_03", type:"Automation", date:"2025-09-02",
        category:["Welcome Series","In Store","VIP"], tags:["VIP","In-store"],
        path:"Emails/GRB/House/[FUTURE STATE] Welcome Series (Online & In Store)/Auto_WelcomeSeries_InStore_VIP_Email_03.html",
        notes:"Benefits recap, top brands, categories" },
      { id:"Auto_WelcomeSeries_InStore_VIP_NoCode_Email_02", type:"Automation", date:"2025-09-03",
        category:["Welcome Series","In Store","VIP"], tags:["No-code","VIP","In-store"],
        path:"Emails/GRB/House/[FUTURE STATE] Welcome Series (Online & In Store)/Auto_WelcomeSeries_InStore_VIP_NoCode_Email_02.html",
        notes:"No-code branch for VIP — incentive removed / value-led content" },

      /* VIP Anniversary Offer */
      { id:"AP_TR_VIP_AV_E1", type:"Automation", date:"2025-09-06",
        category:["VIP Anniversary"], tags:["VIP","Anniversary"],
        path:"Emails/GRB/House/VIP Anniversary Offer/AP_TR_VIP_AV_E1.html",
        notes:"VIP Anniversary Email 1" },
      { id:"AP_TR_VIP_AV_E2", type:"Automation", date:"2025-09-04",
        category:["VIP Anniversary"], tags:["VIP","Anniversary"],
        path:"Emails/GRB/House/VIP Anniversary Offer/AP_TR_VIP_AV_E2.html",
        notes:"VIP Anniversary Email 2" },

      /* Cross-Sell Product Focused */
      { id:"NEW_Cross-sell_Bacc_PastaMachine_DryingRack_1", type:"Automation", date:"2025-09-06",
        category:["Cross-Sell Product Focused"], tags:["Cross-sell"],
        path:"Emails/GRB/House/[Future State] Cross-Sell Product Focused/NEW_Cross-sell_Journey_Bacc_PastaMachine_DryingRack_1.html",
        notes:"Cross-sell — Pasta Machine × Drying Rack" },
      { id:"NEW_Cross-sell_Bacc_STONEX2_RiceCooker_1", type:"Automation", date:"2025-09-04",
        category:["Cross-Sell Product Focused"], tags:["Cross-sell"],
        path:"Emails/GRB/House/[Future State] Cross-Sell Product Focused/NEW_Cross-sell_Journey_Bacc_STONEX2_RiceCooker_1.html",
        notes:"Cross-sell — StoneX2 × Rice Cooker (1)" },
      { id:"NEW_Cross-sell_Bacc_STONEX2_RiceCooker_2", type:"Automation", date:"2025-09-04",
        category:["Cross-Sell Product Focused"], tags:["Cross-sell"],
        path:"Emails/GRB/House/[Future State] Cross-Sell Product Focused/NEW_Cross-sell_Journey_Bacc_STONEX2_RiceCooker_2.html",
        notes:"Cross-sell — StoneX2 × Rice Cooker (2)" },
      { id:"NEW_Cross-sell_Bacc_Toaster_Kettle_1_2", type:"Automation", date:"2025-09-04",
        category:["Cross-Sell Product Focused"], tags:["Cross-sell"],
        path:"Emails/GRB/House/[Future State] Cross-Sell Product Focused/NEW_Cross-sell_Journey_Bacc_Toaster_Kettle_1.2.html",
        notes:"Cross-sell — Toaster × Kettle (1.2)" },
      { id:"NEW_Cross-sell_Bacc_Toaster_Kettle_1", type:"Automation", date:"2025-09-04",
        category:["Cross-Sell Product Focused"], tags:["Cross-sell"],
        path:"Emails/GRB/House/[Future State] Cross-Sell Product Focused/NEW_Cross-sell_Journey_Bacc_Toaster_Kettle_1.html",
        notes:"Cross-sell — Toaster × Kettle (1)" },
      { id:"NEW_Cross-sell_Bacc_Toaster_Kettle_2_2", type:"Automation", date:"2025-09-04",
        category:["Cross-Sell Product Focused"], tags:["Cross-sell"],
        path:"Emails/GRB/House/[Future State] Cross-Sell Product Focused/NEW_Cross-sell_Journey_Bacc_Toaster_Kettle_2.2.html",
        notes:"Cross-sell — Toaster × Kettle (2.2)" },
      { id:"NEW_Cross-sell_Bacc_Toaster_Kettle_2", type:"Automation", date:"2025-09-04",
        category:["Cross-Sell Product Focused"], tags:["Cross-sell"],
        path:"Emails/GRB/House/[Future State] Cross-Sell Product Focused/NEW_Cross-sell_Journey_Bacc_Toaster_Kettle_2.html",
        notes:"Cross-sell — Toaster × Kettle (2)" },

      /* Re-Engagement */
      { id:"Re-engagement - Email 1", type:"Automation", date:"2025-09-06",
        category:["Re-Engagement"], tags:["Re-Engagement"],
        path:"Emails/GRB/House/[FUTURE STATE] Re-Engagement Flow/Re-engagement - Email 1.html",
        notes:"Re-Engagement Email 1" },
      { id:"Re-engagement - Email 2", type:"Automation", date:"2025-09-04",
        category:["Re-Engagement"], tags:["Re-Engagement"],
        path:"Emails/GRB/House/[FUTURE STATE] Re-Engagement Flow/Re-engagement - Email 2.html",
        notes:"Re-Engagement Email 2" },
      { id:"Re-engagement - Email 3", type:"Automation", date:"2025-09-06",
        category:["Re-Engagement"], tags:["Re-Engagement"],
        path:"Emails/GRB/House/[FUTURE STATE] Re-Engagement Flow/Re-engagement - Email 3.html",
        notes:"Re-Engagement Email 3" },
      { id:"Re-engagement - Email 4", type:"Automation", date:"2025-09-04",
        category:["Re-Engagement"], tags:["Re-Engagement"],
        path:"Emails/GRB/House/[FUTURE STATE] Re-Engagement Flow/Re-engagement - Email 4.html",
        notes:"Re-Engagement Email 4" },

      /* Post-Purchase (Categories) */
      { id:"Post Purchase - Airfryers - Email 1", type:"Automation", date:"2025-09-06",
        category:["Post-Purchase"], tags:["Post-Purchase"],
        path:"Emails/GRB/House/[FUTURE STATE] Post-Purchase (Categories)/Post Purchase - Airfryers - Email 1.html",
        notes:"Post-Purchase — Airfryers (Email 1)" },
      { id:"Post Purchase - Cookware - Baccarat NOOK - Email 1", type:"Automation", date:"2025-09-04",
        category:["Post-Purchase"], tags:["Post-Purchase"],
        path:"Emails/GRB/House/[FUTURE STATE] Post-Purchase (Categories)/Post Purchase - Cookware - Baccarat NOOK - Email 1.html",
        notes:"Post-Purchase — Cookware (NOOK) (Email 1)" },
      { id:"Post Purchase - Cookware - Baccarat Non-stick - Email 1", type:"Automation", date:"2025-09-06",
        category:["Post-Purchase"], tags:["Post-Purchase"],
        path:"Emails/GRB/House/[FUTURE STATE] Post-Purchase (Categories)/Post Purchase - Cookware - Baccarat Non-stick - Email 1.html",
        notes:"Post-Purchase — Non-stick Cookware (Email 1)" },
      { id:"Post Purchase - Cookware - Baccarat Stainless Steel - Email 1", type:"Automation", date:"2025-09-04",
        category:["Post-Purchase"], tags:["Post-Purchase"],
        path:"Emails/GRB/House/[FUTURE STATE] Post-Purchase (Categories)/Post Purchase - Cookware - Baccarat Stainless Steel - Email 1.html",
        notes:"Post-Purchase — Stainless Steel Cookware (Email 1)" },
      { id:"Post Purchase - Kettles - Email 1", type:"Automation", date:"2025-09-06",
        category:["Post-Purchase"], tags:["Post-Purchase"],
        path:"Emails/GRB/House/[FUTURE STATE] Post-Purchase (Categories)/Post Purchase - Kettles - Email 1.html",
        notes:"Post-Purchase — Kettles (Email 1)" },
      { id:"Post Purchase - Knife blocks - Baccarat - Email 1", type:"Automation", date:"2025-09-04",
        category:["Post-Purchase"], tags:["Post-Purchase"],
        path:"Emails/GRB/House/[FUTURE STATE] Post-Purchase (Categories)/Post Purchase - Knife blocks - Baccarat - Email 1.html",
        notes:"Post-Purchase — Knife Blocks (Email 1)" },

      /* Abandoned Cart — placeholders (Fast + External Event) */
      { id:"AP_TR_AC_F_E1", type:"Automation", date:"2025-09-30",
        category:["Abandoned Cart"], tags:["Fast AC"],
        path:"Emails/GRB/House/[FUTURE STATE] Fast Abandoned Cart - Advanced/AP_TR_AC_F_E1.html",
        notes:"Abandoned Cart Email 1" },
      { id:"AP_TR_AC_F_E1_KNIVES", type:"Automation", date:"2025-09-29",
        category:["Abandoned Cart"], tags:["Fast AC"],
        path:"Emails/GRB/House/[FUTURE STATE] Fast Abandoned Cart - Advanced/AP_TR_AC_F_E1_KNIVES.html",
        notes:"Abandoned Cart Email 1B" },
      { id:"AP_TR_AC_F_E2", type:"Automation", date:"2025-09-28",
        category:["Abandoned Cart"], tags:["Fast AC"],
        path:"Emails/GRB/House/[FUTURE STATE] Fast Abandoned Cart - Advanced/AP_TR_AC_F_E2.html",
        notes:"Abandoned Cart Email 2" },
      { id:"AP_TR_AC_F_TP_E2", type:"Automation", date:"2025-09-27",
        category:["Abandoned Cart"], tags:["Fast AC"],
        path:"Emails/GRB/House/[FUTURE STATE] Fast Abandoned Cart - Advanced/AP_TR_AC_F_TP_E2.html",
        notes:"Abandoned Cart Email 2B" },

      { id:"[FUTURE STATE] Fast Abandoned Cart - External Event", type:"Automation", date:"2025-09-30",
        category:["Abandoned Cart (External)"], tags:["External Event"],
        path:"Emails/GRB/House/[FUTURE STATE] Fast Abandoned Cart - External Event/AP_TR_AC_EX_E1 - External Event.html",
        notes:"Fast Abandoned Cart External Event Email 1" },
      { id:"AP_TR_AC_F_TP_E2 - External Event", type:"Automation", date:"2025-09-29",
        category:["Abandoned Cart (External)"], tags:["External Event"],
        path:"Emails/GRB/House/[FUTURE STATE] Fast Abandoned Cart - External Event/AP_TR_AC_F_TP_E2 - External Event.html",
        notes:"Fast Abandoned Cart External Event Email 2 - AB TEST Trade Period" },
      { id:"AP_TR_AC_F_E2 - External Event", type:"Automation", date:"2025-09-28",
        category:["Abandoned Cart (External)"], tags:["External Event"],
        path:"Emails/GRB/House/[FUTURE STATE] Fast Abandoned Cart - External Event/AP_TR_AC_F_E2 - External Event.html",
        notes:"Fast Abandoned Cart External Event Email 2 - AB TEST Normal Period" },
      { id:"AP_TR_AC_F_E1_KNIVES - External Event", type:"Automation", date:"2025-09-27",
        category:["Abandoned Cart (External)"], tags:["External Event"],
        path:"Emails/GRB/House/[FUTURE STATE] Fast Abandoned Cart - External Event/AP_TR_AC_F_E1_KNIVES - External Event.html",
        notes:"Fast Abandoned Cart External Event KNIVES -place holder " }
    ];

    /* ===== BELOW HERE: logic (don’t edit) ===== */
    const q = document.getElementById('q');
    const typeSel = document.getElementById('type');
    const sortSel = document.getElementById('sort');
    const progFilterSel = document.getElementById('programFilter');
    const programsView = document.getElementById('programs-view');
    const emailsView = document.getElementById('emails-view');
    const tabPrograms = document.getElementById('tab-programs');
    const tabEmails   = document.getElementById('tab-emails');

    const overlay = document.getElementById('overlay');
    const ovTitle = document.getElementById('ov-title');
    const ovFrame = document.getElementById('ov-frame');
    const ovOpen  = document.getElementById('ov-open');
    const ovDown  = document.getElementById('ov-download');
    const ovClose = document.getElementById('ov-close');

    const pOverlay = document.getElementById('prog-overlay');
    const pTitle = document.getElementById('prog-title');
    const pImg = document.getElementById('prog-img');
    const pSummary = document.getElementById('prog-summary');
    const pBullets = document.getElementById('prog-bullets');
    const pEmails = document.getElementById('prog-emails');
    const pEmailsTitle = document.getElementById('prog-emails-title');
    const pClose = document.getElementById('prog-close');

    // Build filters
    (TYPES_PRESET||["Marketing","Automation","Transactional"]).forEach(t=>{
      const o=document.createElement('option'); o.value=t; o.textContent=t; typeSel.appendChild(o);
    });
    PROGRAMS.forEach(p=>{
      const o=document.createElement('option'); o.value=p.id; o.textContent=p.title; progFilterSel.appendChild(o);
    });

    const basePath = location.pathname.replace(/index\.html?$/,'');
    function buildHref(rawPath){
      let p = (rawPath||'').trim();
      if(!p) return '';
      if(!/\.[a-z0-9]+$/i.test(p)) p += '.html';                 // ensure .html
      p = p.split('/').map(seg => encodeURIComponent(seg)).join('/'); // encode each segment
      return basePath + p;
    }
    function formatDate(iso){
      if(!iso) return "";
      const d = new Date(iso+"T00:00:00Z");
      return isNaN(d) ? iso : d.toLocaleDateString(undefined,{year:'numeric',month:'short',day:'2-digit'});
    }
    function copyToClipboard(text){
      navigator.clipboard.writeText(text).then(()=>{ alert('Link copied to clipboard'); }).catch(()=>{});
    }
    async function fileExists(url){
      try{ const res = await fetch(url, { method:'HEAD', cache:'no-store' }); return res.ok; }catch(e){ return false; }
    }
    function closeProgramOverlay(){
      pOverlay.classList.remove('show'); pOverlay.setAttribute('aria-hidden','true'); pImg.removeAttribute('src');
    }
    function openEmailOverlay(title, href){
      closeProgramOverlay(); // ensure email overlay is on top
      ovTitle.textContent = title; ovFrame.src = href; ovOpen.href = href; ovDown.href = href;
      overlay.classList.add('show'); overlay.setAttribute('aria-hidden','false');
    }
    function closeEmailOverlay(){
      overlay.classList.remove('show'); overlay.setAttribute('aria-hidden','true'); ovFrame.removeAttribute('src');
    }
    ovClose.addEventListener('click', closeEmailOverlay);
    overlay.addEventListener('click', (e)=>{ if(e.target===overlay) closeEmailOverlay(); });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape'){ closeEmailOverlay(); closeProgramOverlay(); }});

    // Close program overlay with button or click-outside
    pClose.addEventListener('click', closeProgramOverlay);
    pOverlay.addEventListener('click', (e)=>{ if(e.target===pOverlay) closeProgramOverlay(); });

    function emailsForProgram(progId){
      const prog = PROGRAMS.find(p=>p.id===progId);
      if(!prog) return [];
      if(prog.emailIds && prog.emailIds.length){
        const set = new Set(prog.emailIds); return EMAILS.filter(e=>set.has(e.id));
      }
      if(prog.categoryForEmails){
        return EMAILS.filter(e=> (e.category||[]).includes(prog.categoryForEmails));
      }
      return [];
    }

    // Programs tab rendering (supports program filter + A→Z sort)
    function renderPrograms(){
      const query = (q.value||'').trim().toLowerCase();
      const selectedProgId = progFilterSel.value;
      const sort = sortSel.value;

      programsView.innerHTML = '';
      let items = PROGRAMS.slice();

      if(query){
        items = items.filter(p =>
          [p.title, p.summary, (p.bullets||[]).join(' ')].join(' ').toLowerCase().includes(query)
        );
      }
      if (selectedProgId) {
        items = items.filter(p => p.id === selectedProgId);
      }
      if (sort === 'name_asc') {
        items.sort((a,b) => a.title.localeCompare(b.title));
      }

      if(items.length===0){
        const empty=document.createElement('div'); empty.className='card';
        empty.innerHTML = '<div class="muted">No programs match your filters.</div>';
        programsView.appendChild(empty); return;
      }

      items.forEach(p=>{
        const card=document.createElement('article'); card.className='card';
        const img = p.image ? (basePath + p.image.split('/').map(encodeURIComponent).join('/')) : '';
        card.innerHTML = `
          ${ img ? `<img class="thumb" src="${img}" alt="${p.title}">`
                 : '<div class="thumb" style="display:flex;align-items:center;justify-content:center;color:#556">No image</div>' }
          <div class="row">
            <div style="font-weight:700">${p.title}</div>
            <span class="badge orange">${p.noEmails ? 'Info only' : 'Program'}</span>
          </div>
          <div class="muted">${p.summary||''}</div>
          <div class="actions"><button class="btn primary">Open program</button></div>`;

        card.querySelector('.primary').addEventListener('click',()=>{
          pTitle.textContent = p.title;
          pImg.src = p.image ? (basePath + p.image.split('/').map(encodeURIComponent).join('/')) : '';
          pSummary.textContent = p.summary||'';
          pBullets.innerHTML = (p.bullets||[]).map(b=>`<li>${b}</li>`).join('');
          pEmails.innerHTML = '';

          if(p.noEmails){
            pEmailsTitle.textContent = "About this program";
            const info=document.createElement('div'); info.className='card';
            info.innerHTML = '<div class="muted">This flow acts as a traffic controller that routes shoppers to category-specific campaigns outside this program. No emails are sent directly by this canvas.</div>';
            pEmails.appendChild(info);
          } else {
            pEmailsTitle.textContent = "Included Emails";
            const matched = emailsForProgram(p.id);
            if(matched.length===0){
              const empty=document.createElement('div'); empty.className='card';
              empty.innerHTML = '<div class="muted">No mapped emails yet (add EMAILS with matching category).</div>';
              pEmails.appendChild(empty);
            }else{
              matched.forEach(e=>{
                const href = buildHref(e.path);
                const el=document.createElement('article'); el.className='card';
                const isPH = !!e.placeholder;
                el.innerHTML = `
                  <div class="row">
                    <div style="font-weight:700">${e.id.replaceAll('_',' ')}</div>
                    <div class="badge">${e.type}</div>
                    ${isPH ? '<div class="badge orange">Placeholder</div>' : ''}
                  </div>
                  <div class="meta">
                    <span class="badge">${formatDate(e.date)}</span>
                    ${(e.tags||[]).map(t=>`<span class="badge">#${t}</span>`).join('')}
                  </div>
                  <div class="actions">
                    <button class="btn primary ${isPH?'disabled':''}">View</button>
                    <button class="btn ${isPH?'disabled':''}">Copy link</button>
                  </div>
                  ${ e.notes ? `<div class="muted" style="font-size:12px">${e.notes}</div>` : '' }`;
                if(!isPH){
                  el.querySelector('.primary').addEventListener('click', async ()=>{
                    if(!(await fileExists(href))){ alert("File not found:\n"+href+"\n\nCheck the path/casing and .html file in the repo."); return; }
                    openEmailOverlay(e.id.replaceAll('_',' '), href);
                  });
                  el.querySelector('.btn:not(.primary)').addEventListener('click',()=> copyToClipboard(location.origin + href));
                }
                pEmails.appendChild(el);
              });
            }
          }

          pOverlay.classList.add('show'); pOverlay.setAttribute('aria-hidden','false');
        });

        programsView.appendChild(card);
      });
    }

    function renderEmails(){
      const query  = (q.value||'').trim().toLowerCase();
      const type   = typeSel.value;
      const sort   = sortSel.value;
      const progId = progFilterSel.value;

      let rows = EMAILS.slice();
      if(progId){
        const ids = new Set(emailsForProgram(progId).map(e=>e.id));
        rows = rows.filter(e=>ids.has(e.id));
      }
      rows = rows.filter(e=>{
        const inType = !type || e.type===type;
        const hay = [e.id,(e.category||[]).join(' '),(e.tags||[]).join(' '),e.notes||''].join(' ').toLowerCase();
        return inType && (!query || hay.includes(query));
      });
      rows.sort((a,b)=>{ if(sort==='name_asc') return a.id.localeCompare(b.id); if(sort==='date_asc') return a.date.localeCompare(b.date); return b.date.localeCompare(a.date); });

      emailsView.innerHTML='';
      if(rows.length===0){
        const empty=document.createElement('div'); empty.className='card';
        empty.innerHTML = '<div class="muted">No emails match your filters.</div>';
        emailsView.appendChild(empty); return;
      }
      rows.forEach(e=>{
        const href = buildHref(e.path);
        const isPH = !!e.placeholder;
        const card=document.createElement('article'); card.className='card';
        card.innerHTML = `
          <div class="row">
            <div style="font-weight:700">${e.id.replaceAll('_',' ')}</div>
            <div class="badge" title="${e.type}">${e.type}</div>
            ${isPH ? '<div class="badge orange">Placeholder</div>' : ''}
          </div>
          <div class="meta">
            <span class="badge" title="Date">${formatDate(e.date)}</span>
            ${(e.category||[]).map(c=>`<span class="badge">${c}</span>`).join('')}
            ${(e.tags||[]).map(t=>`<span class="badge">#${t}</span>`).join('')}
          </div>
          <div class="code">${e.path}</div>
          <div class="actions">
            <button class="btn primary ${isPH?'disabled':''}">View</button>
            <button class="btn ${isPH?'disabled':''}">Copy link</button>
            <a class="btn ghost ${isPH?'disabled':''}" ${isPH?'tabindex="-1"':''} href="${isPH?'#':href}" ${isPH?'':'download'}>Download HTML</a>
          </div>
          ${ e.notes ? `<div class="muted" style="font-size:12px">${e.notes}</div>` : '' }`;
        if(!isPH){
          card.querySelector('.primary').addEventListener('click', async ()=>{
            if(!(await fileExists(href))){ alert("File not found:\n"+href+"\n\nCheck the path/casing and .html file in the repo."); return; }
            openEmailOverlay(e.id.replaceAll('_',' '), href);
          });
          card.querySelector('.btn:not(.primary)').addEventListener('click', ()=> copyToClipboard(location.origin + href));
        }
        emailsView.appendChild(card);
      });
    }

    function renderAll(){
      const programsSelected = tabPrograms.getAttribute('aria-selected') === 'true';
      programsView.style.display = programsSelected ? '' : 'none';
      emailsView.style.display   = programsSelected ? 'none' : '';
      programsSelected ? renderPrograms() : renderEmails();
    }

    // Tabs
    tabPrograms.addEventListener('click', ()=>{ tabPrograms.setAttribute('aria-selected','true'); tabEmails.setAttribute('aria-selected','false'); renderAll(); });
    tabEmails  .addEventListener('click', ()=>{ tabPrograms.setAttribute('aria-selected','false'); tabEmails .setAttribute('aria-selected','true');  renderAll(); });

    // Filters
    q.addEventListener('input', renderAll);
    typeSel.addEventListener('change', renderAll);
    sortSel.addEventListener('change', renderAll);
    progFilterSel.addEventListener('change', renderAll);

    // Footer year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Initial render
    renderAll();
  </script>
</body>
</html>
